# ğŸ§ª Google Test ç¤ºä¾‹é¡¹ç›®
cmake_minimum_required(VERSION 3.16)
project(GoogleTestDemo)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ğŸ” æŸ¥æ‰¾Google Test (å¦‚æœç³»ç»Ÿå®‰è£…äº†)
find_package(GTest QUIET)

if(NOT GTest_FOUND)
    # ğŸ“¦ å¦‚æœæ²¡æ‰¾åˆ°ï¼Œæˆ‘ä»¬ä¸‹è½½å¹¶æ„å»ºGoogle Test
    message(STATUS "Google Test not found, downloading...")
    
    include(FetchContent)
    FetchContent_Declare(
        googletest
        URL https://github.com/google/googletest/archive/refs/tags/v1.14.0.zip
    )
    
    # For Windows: Prevent overriding the parent project's compiler/linker settings
    set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
    FetchContent_MakeAvailable(googletest)
else()
    message(STATUS "Found Google Test")
endif()

# ğŸ§ª åˆ›å»ºæµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶
add_executable(basic_test basic_assertions_simple.cpp)
add_executable(sensor_test sensor_test_simple.cpp)

# ğŸ”— é“¾æ¥Google Test
target_link_libraries(basic_test gtest_main)
target_link_libraries(sensor_test gtest_main)

# âœ… æ·»åŠ æµ‹è¯•
enable_testing()
add_test(NAME BasicAssertions COMMAND basic_test)
add_test(NAME SensorTests COMMAND sensor_test)

# ğŸ“Š è¾“å‡ºä¿¡æ¯
message(STATUS "ğŸ§ª Google Testç¤ºä¾‹é¡¹ç›®é…ç½®å®Œæˆ")
message(STATUS "ğŸ“ æ„å»ºç›®å½•: ${CMAKE_BINARY_DIR}")
message(STATUS "ğŸ”¨ æ„å»ºå‘½ä»¤: cmake --build .")
message(STATUS "ğŸƒ è¿è¡Œæµ‹è¯•: ctest æˆ–ç›´æ¥è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶")
